
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Good Practices to Use a KafkaConsumer</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css" integrity="sha384-SI27wrMjH3ZZ89r4o+fGIJtnzkAnFs3E4qz9DIYioCQ5l9Rd/7UAa8DHcaL8jkWt" crossorigin="anonymous">
    <style>
      pre { background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; padding: 0.6em 1em; }
      h1,h2 { margin-top: 1em; }
      div.navbar { padding: 8px 0; }
      div.toc { float: right; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 id="good-practices-to-use-a-kafkaconsumer"><a class="toclink" href="#good-practices-to-use-a-kafkaconsumer">Good Practices to Use a KafkaConsumer</a></h1>
<p>If we want to achieve high performance/availability, here're some rules of thumb.</p>
<h2 id="how-to-distribute-the-messages-for-the-same-topics-to-different-kafkaconsumers"><a class="toclink" href="#how-to-distribute-the-messages-for-the-same-topics-to-different-kafkaconsumers">How to distribute the messages (for the same topics) to different KafkaConsumers</a></h2>
<ul>
<li>
<p>Use a consumer group for these KafkaConsumers, thus they will work together -- each one deals with different partitions.</p>
</li>
<li>
<p>Besides <code>subscribe</code> (topics), users could also choose to explicitly <code>assign</code> certain partitions to a <code>KafkaConsumer</code>.</p>
</li>
</ul>
<h2 id="how-to-enhance-the-throughput"><a class="toclink" href="#how-to-enhance-the-throughput">How to enhance the throughput</a></h2>
<ul>
<li>
<p>Try with a larger <code>QUEUED_MIN_MESSAGES</code>, especially for small messages.</p>
</li>
<li>
<p>Use multiple KafkaConsumers to distribute the payload.</p>
</li>
</ul>
<h2 id="how-to-avoid-polling-duplicated-messages"><a class="toclink" href="#how-to-avoid-polling-duplicated-messages">How to avoid polling duplicated messages</a></h2>
<ul>
<li>
<p>To commit the offsets more frequently (e.g, always do commit after finishing processing a message).</p>
</li>
<li>
<p>Don't use quite a large <code>MAX_POLL_RECORDS</code> for a <code>KafkaConsumer</code> (with <code>enable.auto.commit=true</code>) -- you might fail to commit all these messages before crash, thus more duplications with the next <code>poll</code>.</p>
</li>
</ul>
      <hr/>
      <footer class="text-center text-muted">
        Generated: 2022. 03. 15
      </footer>
      <hr/>
    </div>
  </body>
</html>